<tal:doctype xmlns:tal="http://xml.zope.org/namespaces/tal"
             tal:define="omit view/omit|nothing">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmln:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="lmu.contenttypes.blog"
      tal:omit-tag="omit" >

    <metal:block fill-slot="javascript_head_slot">
        <tal:script tal:replace='structure string:<script type="text/javascript">' />
        (function($) {
            function set_up_functions() {
                $('.itemorder').ajaxForm({
                    success: function () {
                        $.ajax().done(
                            function(html) {
                                $("#files").replaceWith($(html).find("#files"));
                                set_up_functions();
                            }
                        );
                    }
                });
            }
            $(function() {
                set_up_functions();
            })
        })(jQuery);
        <tal:script tal:replace='structure string:</script>' />
    </metal:block>

    <metal:block fill-slot="main">
        <div class="clearfix">
            <h1 class="documentFirstHeading" tal:content="view/label | nothing" />
        </div>
        <div id="content-core">
            <div id="folder_contents_sort">
                <h2 i18n:translate="" class="helper-margin-top-l">Files</h2>
                <div id="files" class="file_listing" tal:condition="view/files">
                  <div class="row helper-border-top helper-margin-bottom-s" tal:repeat="item view/files">
                    <div class="column small-10" >
                      <h3 ><span tal:replace="item/title" >Titel</span> <small>(<span tal:replace="item/type" />, <span tal:replace="item/size" />)</small></h3>
                      <p tal:content="item/description" tal:condition="item/description" tal:on-error="nothing">Description</p>
                    </div>

                    <div class="column small-2">
                        <form class="itemorder" action="fc-itemOrder" method="post" tal:attributes="id string:functions-${item/id}">
                            <input type="hidden" name="id" value="test.png" tal:attributes="value item/id" />
                            <input type="hidden" name="subset_ids" value="['test.png']" tal:attributes="value view/subset_ids" />
                            <span tal:replace="structure context/@@authenticator/authenticator" />
                            <ul class="inline-list right">
                            <li tal:condition="item/delta_up|nothing">
                                    <button type="submit" name="delta" value="1" tal:attributes="value item/delta_up">
                                        <img src="arrowUp.png" alt="Up" title="Up" />
                                    </button>
                            </li>
                            <li tal:condition="item/delta_down|nothing">
                                    <button type="submit" name="delta" value="-1" tal:attributes="value item/delta_down">
                                        <img src="arrowDown.png" alt="Down" title="Down" />
                                    </button>
                            </li>
                            </ul>
                        </form>
                    </div>

                  </div>
                </div>
                <div id="files" class="file_listing" tal:condition="not: view/files">
                    <div class="row helper-border-top helper-margin-bottom-s" >
                        <div class="column small-10" >
                            <p i18n:translate="">No Files Uploaded</p>
                        </div>
                    </div>
                </div>

            </div>
        </div>

    </metal:block>
</html>
</tal:doctype>
