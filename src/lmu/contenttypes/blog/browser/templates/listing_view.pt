<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="lmu.blog">

<body>

  <metal:content fill-slot="content">

    <main id="content" class="blog">
      <header id="blog-header" class="row">
        <div class="columns small-12 large-10 large-centered helper-margin-top-l">
          <h1>
            <span tal:replace="context/title">Blog Titel</span> 
            <small tal:content="context/description" tal:condition="context/description">Blog Sub-Title</small>
          </h1>
          <a class="button small-12"
             tal:define="add_url string:${context/absolute_url}/++add++Blog Entry;"
             tal:attributes="href add_url;"
             tal:condition="view/canAdd"
             i18n:translate="">
            Jetzt einen Blog-Beitrag verfassen
          </a>
        </div>
      </header>
      <div id="blog-main" class="row">
        <div class="columns small-12 large-10 large-centered " >
        <tal:block tal:repeat="entry view/entries"
                   tal:define="isAnon context/@@plone_portal_state/anonymous;
                               normalizeString nocall: context/plone_utils/normalizeString;
                               toLocalizedTime nocall: context/@@plone/toLocalizedTime;
                               site_properties context/portal_properties/site_properties;
                               use_view_action site_properties/typesUseViewActionInListings|python:();
                               show_about python:not isAnon or site_properties.allowAnonymousViewAbout;
                               navigation_root_url context/@@plone_portal_state/navigation_root_url;
                               pas_member context/@@pas_member;
                              ">
          <article class="blog-entry blog-preview tileItem visualIEFloatFix clearfix" 
                   tal:define="item entry/getObject;
                               item_creator entry/Creator;
                               item_type entry/portal_type;
                               item_modified entry/ModificationDate;
                               item_url item/getURL|item/absolute_url;
                               member python:view.get_memberdata(item);
                               text python:view.strip_text(item);
                               islast repeat/entry/end;
                               last python: 'lastTileItem' if islast else '';
                               sklass string:row blog-entry tileItem ${last} visualIEFloatFix">

            <div class="blog-preview-counter" >
              <a class="comment-sign"
                 tal:attributes="href python:str(item.absolute_url())+'#commenting';
                                 title string:'Jump to Comments';"
                 i18n:translate="">
                <span tal:content="item/getDiscussionCount" >Anzahl</span>
              </a>
            </div>
            <figure tal:define="scales item/@@images;"
                    tal:condition="item/image" 
                    class="blog-lead-image tileImage small-4 left helper-margin-right-m helper-margin-bottom-m ">
              <a href="#"
                 tal:attributes="href python: item_type in use_view_action and item_url+'/view' or item_url">
                <picture>
                  <source media="(min-width: 64em)" tal:define="scaled_image python: scales.scale('image', scale='xlarge');" tal:attributes="srcset scaled_image/url;"/>
                  <source media="(min-width: 52em)" tal:define="scaled_image python: scales.scale('image', scale='large');" tal:attributes="srcset scaled_image/url;"/>
                  <source media="(min-width: 42em)" tal:define="scaled_image python: scales.scale('image', scale='preview');" tal:attributes="srcset scaled_image/url;" />
                  <source media="(min-width: 36em)" tal:define="scaled_image python: scales.scale('image', scale='mini');" tal:attributes="srcset scaled_image/url;" />
                  <source media="(min-width: 24em)" tal:define="scaled_image python: scales.scale('image', scale='thumb');" tal:attributes="srcset scaled_image/url;" />
                  <img tal:replace="structure python: scales.tag('image', scale='preview', alt=item.image_caption)" />
                </picture>
                <figcaption tal:content="item/image_caption" tal:condition="item/image_caption">Caption</figcaption>
              </a>
            </figure>

            <hgroup >
              <h2 class="tileHeadline">
                <a tal:attributes="href item/absolute_url; 
                                   title item/title;"
                   tal:content="item/title">Blog Entry Title</a>
              </h2>
              <div class="tileDocumentByLine documentByLine helper-font-serif" 
                   tal:condition="python: site_properties.allowAnonymousViewAbout or not isAnon"
                   tal:define="author python:pas_member.info(item_creator);">
                <a href="#"
                   tal:attributes="href string:${navigation_root_url}/author/${item_creator}"
                   tal:content="author/name_or_id"
                   tal:omit-tag="not:author">
                  Bob Dobalina
                </a> 
                <date tal:content="python: toLocalizedTime(item_modified,long_format=1)">Date</date>
              </div>
            </hgroup>

            <div class="tileBody" >
              <tal:tileBody tal:content="structure item/text/output">
                Content Body
              </tal:tileBody>
              <p class="visualClear">
                <a tal:define='content string:Read Comments for "${item/title}" / Write a comment;'
                   tal:attributes="href python:str(item.absolute_url())+'#commenting';
                                   title content;"
                   tal:content="content"
                   i18n:translate="" >Rede Comments for</a>
              </p>
              <div class="visualClear clearfix" ></div>
            </div>
          </article>
        </tal:block>
        </div>
      </div>
      <footer id="blog-footer" class="row"
              tal:condition="view/canAdd">
        <div class="columns small-12 large-10 large-centered">
          <a class="button small-12"
             tal:define="add_url string:${context/absolute_url}/++add++Blog Entry;"
             tal:attributes="href add_url;"
             i18n:translate="">
            Jetzt einen Blog-Beitrag verfassen
          </a>
        </div>
      </footer>
    </main>
  </metal:content>

</body>
</html>
