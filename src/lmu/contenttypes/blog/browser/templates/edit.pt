<html xmlns="http://www.w3.org/1999/xhtml"
     xmln:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="plone">

    <metal:block fill-slot="javascript_head_slot">
      <script type="text/javascript">
(function($) {
    $(function() {
        $("a[href$='@@croppingeditor']").prepOverlay({
            subtype:'ajax',
            formselector:'#coords',
            closeselector:"input[name='form.button.Cancel']"
        });

        // workaround this MSIE bug :
        // https://dev.plone.org/plone/ticket/10894
        if ($.browser.msie) $("#settings").remove();
        var Browser = {};
        Browser.onUploadComplete = function() {
            $.ajax().done(
                function(html) {
                    $(".image-previews").replaceWith($(html).find(".image-previews"));
                    $(".file-previews").replaceWith($(html).find(".file-previews"));
                }
            );
        }
        loadUploader = function() {
            var ulContainer = $('.QuickUploadPortlet .uploaderContainer');
            ulContainer.each(function(){
                var uploadUrl =  $('.uploadUrl', this).val();
                var uploadData =  $('.uploadData', this).val();
                var UlDiv = $(this);
            $.ajax({
                        type: 'GET',
                        url: uploadUrl,
                        data: uploadData,
                        dataType: 'html',
                        contentType: 'text/html; charset=utf-8',
                        success: function(html) {
                            if (html.indexOf('quick-uploader') != -1) {
                                UlDiv.html(html);
                            }
                        } });
        });
    }
    $(document).ready(loadUploader);

    })
})(jQuery);
      </script>
    </metal:block>

    <metal:block fill-slot="main">

        <a class="toogle button radius small right" href="#" data-reveal-id="rules" i18n:translate="" >Show Blog Rules</a>
        <h1 class="documentFirstHeading" tal:content="view/label | nothing" />
        <div id="rules" class="blog_info reveal-modal xlarge" data-reveal aria-labelledby="" aria-hidden="true" role="dialog" style="top: -8em;">
            <tal:rules tal:define="parent context/getParentNode;
                                   output parent/text/output"
                tal:content="structure output">
                Content Body
            </tal:rules>
            <a class="close-reveal-modal" aria-label="Close">&#215;</a>
        </div>
        <div id="content-core">
            <metal:block use-macro="context/@@ploneform-macros/titlelessform">
                <metal:block fill-slot="fields">
                    <metal:block use-macro="context/@@ploneform-macros/fields" />

                    <a href="#" tal:attributes="href string:${context/absolute_url}/@@croppingeditor">Bild zuschneiden</a>

                    <div id="form-widgets-quickupload-help"
                         class="formHelp reveal-modal xlarge"
                         data-reveal
                         aria-labelledby=""
                         aria-hidden="true"
                         role="dialog">
                        <div i18n:translate="" >
                            Please upload additional images or files.
                        </div>
                        <a class="close-reveal-modal" aria-label="Close">&#215;</a>
                    </div>
                    <div class="row field">
                        <div class="column small-12 medium-2">
                            <label for="" class="horizontal inline">
                                Upload additional Images and Files
                            </label>
                        </div>
                        <div class="column small-12 medium-10" >
                            <a class="toogle formHelpToggle inline right helper-margin-left-s"
                               href="#"
                               style="font-size: 2em;"
                               data-reveal-id="form-widgets-quickupload-help" >
                                <i class="fi-info"></i>
                                <span class="show-for-sr" i18n:translate="">Help</span>
                            </a>
                            <div tal:replace="structure view/render_quickupload"></div>
                            <div id="contens">
                                <div id="images" class="image-items">
                                    <ul class="content-previews">
                                        <li tal:repeat="img view/images">
                                            <a href="#" tal:attributes="href string:${img/url}/@@croppingeditor">
                                                <img src="${img/url}/@@images/image/thumb" tal:attributes="src string:${img/url}/@@images/image/thumb" />
                                             </a>
                                        </li>
                                    </ul>
                                </div>
                                <div id="files" class="content-items">
                                    <ul class="file-previews">
                                        <li tal:repeat="obj view/files">
                                            <img src="file_icon.png"/><span tal:content="obj/title">Title</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </metal:block>
            </metal:block>
        </div>

    </metal:block>

</html>
